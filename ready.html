<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<style>
table, th, td {
    border: 1px solid #000000;
}
</style>
<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script>
    // 모델 데이터 배열로 만들겠다.
    // 객체를 만드세요 new
    // 객체에 0개의 배열을 만들겠다.
    var model = new Array(0);
    // test를 위해서 만들어보겠다.
    //     model.push({
    //         name : "jQuery",
    //         age : 100,
    //         address : "전주"
    //     });
    //     model.push({
    //         name : "javaScript",
    //         age : 200,
    //         address : "서울"
    //     });
 
    // Student 에대한 생성자 함수 (prototype)
    // 객체를 만드는 역활
    var Student = function(_name, _age, _address) {
        // new 객체 공간 안에다가 만들기 위해 
        // window 공간에다가 만들어라
        this.name = _name;
        this.age = _age;
        this.address = _address;
    }
    
    // 테이블에 데이터를 추가하기 위한 함수를 만들었다.
    var listOutPrint = function() {
        if (model.length < 1) {
            // 매개변수가 없으면 getter가 된다.
            // 매개변수가 있으면 setter가 된다.
            // 테그가 있는것의 html을 불러와라
            // 매개변수가 있기에 setter가 된다.
            $("#list").html("<tr><td colspan='3'>학생이 없습니다.</td></tr>");
        } else {
            // 데이터 테스트를 하기 위해서 다음과 같이 만들어봤다.
            $("#list").html("");
            $(model).each(
                    function(index, item) {
                        // 데이터를 추가하기 위해서는 html을 사용하는것이아니라 append를 다음과 같이 사용한다.
                        // html은 덮어쓰기 기능이다.
                        // append는 확장 시키는 것이다.
                        $("#list").append(
                                "<tr><td>" + item.name + "</td><td>" + item.age
                                        + "</td><td>" + item.address
                                        + "</td></tr>");
                    });
        }
    }
    // 이름중복검사를 위한 함수 모델에 이름이 있으면 true를 전달하고 없으면 false를 전달한다.
    var nameValidCheck = function(name) {
        for (var i = 0; i < model.length; i++) {
            if (name == model[i].name) {
                return true;
            }
        }
        return false;
    }
 
    // 문서가 모두 준비되면 안에있는 function을 실행하라.
    $(document).ready(
            function() {
                listOutPrint();
                // 추가버튼을 누르면 추가할 수 있게끔 하겠다.
                $("#add").click(
                        function() {
                            if ($("#name").val().length < 2) {
                                // 글자를 입력하기 위해서 text를 사용하였다.
                                $("#nameHelper").text("이름을 입력하시오");
                            } else if (nameValidCheck($("#name").val())) { // 모델안의 동일한 이름이 있는지 검사
                                $("#nameHelper").text("이름이 동일합니다.");
                            } else if ($.isNumeric($("#age").val()) == false) { // 값이 숫자인지 아닌지 판단. $.isNumeric() 결과값이 false와 같으면 다음의 내용 실행
                                $("#nameHelper").text("");
                                $("#ageHelper").text("나이를 입력하시오");
                            } else if ($("#address").val().length < 2) {
                                $("#nameHelper").text("");
                                $("#ageHelper").text("");
                                $("#addressHelper").text("주소를 입력하시오");
                            } else {
                                //                 console.log("else....");
                                $("#nameHelper").text("");
                                $("#ageHelper").text("");
                                $("#addressHelper").text("");
 
                                // 현재는 바로 보여주는 것이지만 
                                // 이곳에 DB에 연결하기 위해서 server쪽으로 보내서 처리한다.
                                model.push(new Student($("#name").val(), $(
                                        "#age").val(), $("#address").val()));
                                console.log(model.length);
                                listOutPrint();
                            }
                        });
                // 수정 버튼을 누르면 내용을 수정하겠다.
                $("#modify").click(function() {
                    if ($("#name").val().length < 2) {
                        // 글자를 입력하기 위해서 text를 사용하였다.
                        $("#nameHelper").text("이름을 입력하시오");
                    } else if (nameValidCheck($("#name").val()) == false) { // 모델안의 동일한 이름이 있는지 검사
                        $("#nameHelper").text("동일한 이름이 존재하지 않습니다.");
                    } else if ($.isNumeric($("#age").val()) == false) { // 값이 숫자인지 아닌지 판단. $.isNumeric() 결과값이 false와 같으면 다음의 내용 실행
                        $("#nameHelper").text("");
                        $("#ageHelper").text("나이를 입력하시오");
                    } else if ($("#address").val().length < 2) {
                        $("#nameHelper").text("");
                        $("#ageHelper").text("");
                        $("#addressHelper").text("주소를 입력하시오");
                    } else {
                        $("#nameHelper").text("");
                        $("#ageHelper").text("");
                        $("#addressHelper").text("");
                        
                        for(var i = 0; i <model.length ; i++) {
                            if($("#name").val() == model[i].name) {
                                model[i].age = $("#age").val();
                                model[i].address = $("#address").val();
                            }
                        }
                        
                        listOutPrint();
                    }
                });
                // 삭제 버튼을 누르면 내용을 삭제하겠다.
                $("#remove").click(function() {
                    if ($("#name").val().length < 2) {
                    } else if ($("#age").val() != "") {
                    } else if ($("#address").val() != "") {
                    } else {
                        for(var i = 0; i <model.length ; i++) {
                            if($("#name").val() == model[i].name) {
                                var s = model.splice(i, 1);
                                alert(s.toString() + "삭제성공~!!");
                            }
                        }
                        
                        listOutPrint();
                    }
                });
 
            });
</script>
</head>
<body>
    <div>
        <h1>학생리스트</h1>
        <table>
            <thead>
                <tr>
                    <th>이름</th>
                    <th>나이</th>
                    <th>주소</th>
                </tr>
            </thead>
            <tbody id="list">
            </tbody>
        </table>
    </div>
    <div>
        <h1>학생입력</h1>
        <table>
            <tr>
                <th>이름</th>
                <td><input id="name" type="text" /><span id="nameHelper"></span></td>
            </tr>
            <tr>
                <th>나이</th>
                <td><input id="age" type="text" /><span id="ageHelper"></span></td>
            </tr>
            <tr>
                <th>주소</th>
                <td><input id="address" type="text" /><span id="addressHelper"></span></td>
            </tr>
        </table>
        <!-- 입력버튼을 누르면 tbody에 내용을 추가한다. -->
        <input id="add" type="button" value="학생입력" />
        <!-- 수정버튼을 누르면 tbody에 내용을 수정한다. -->
        <input id="modify" type="button" value="학생수정" />
        <!-- 삭제버튼을 누르면 tbody에 내용을 삭제한다. -->
        <input id="remove" type="button" value="학생삭제" />
    </div>
</body>
</html>
